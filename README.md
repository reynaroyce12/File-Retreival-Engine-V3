## What This Project Does


This project implements a multithreaded file retrieval engine that indexes text files in an input folder and performs search operations over the indexed data. The program operates on a Client-Server Architecture with multiple clients simultaneosly where only the client has access to the dataset and sends over a partial index to the server to search operations. The program supports the following features:


- Supports multilpe clients for indexing and searching operations in a client and server architecture.
- Indexing a directory and reading files within it.
- Searching for terms within indexed files, supporting both single-term queries and AND-based multiple term queries.
- Displays the time taken for indexing and search operations, along with the total bytes read.

#### A Few Points to Consider:

- Server can be started by running the executable passing the port as the command line argument
- Client can be started by running the executable file.
- Search functionality is **case-sensitive** and supports multi-term search using "AND" to find documents containing all the queried words.
- The engine processes only alphanumeric characters and ignores short words (length ≤ 2).
- if the search query is expressed with an AND query, the result will contain all the documents that contain **all** the terms from the AND query. 
- The results are sorted by the number of accumulated occurrences of all terms in each document, and only the top 10 documents are printed. 
- Validations are present in the program, so in the case of the below scenarios the progarm will print the appropriate messages to the user. 
    - No/invalid/negative thread count provided
    - Invalid Folder path
    - Folder does not exists
    - No folder path specifid
    - Missing search terms
- The program uses Google protocol buffer for encoding and transmitting data. 

#### The program also assumes that your enviroment already has the following installed and configured:

- GCC 14 C++ Compiler
- CMake (For generating build files)
- Git


## Folder and File Structure
The repository follows the below given folder and file structure:

```
app-cpp/
├── build/
├── include/
│   ├── ClientAppInterface.hpp
│   ├── ClientProcessingEngine.hpp
│   ├── IndexStore.hpp
│   ├── ServerAppInterface.hpp
│   ├── ServerProcessingEngine.hpp
├── src/
│   ├── ClientAppInterface.cpp
│   ├── ClientProcessingEngine.cpp
│   ├── file-retrieval-benchmark.cpp
│   ├── file-retrieval-client.cpp
│   ├── file-retrieval-server.cpp
│   ├── IndexStore.cpp
│   ├── ServerAppInterface.cpp
│   ├── ServerProcessingEngine.cpp
├── CMakeLists.txt
├── serverMessages.pb.cc
├── serverMessages.pb.h
├── serverMessages.proto
├── .gitignore
└── README.md
```

## How to build and run the program

### 1. Install Google Protocol Buffer
Since the program uses Protocol Buffers for defining the structure of the messages between the client and server, you need to install Google Protocol Buffers.

To install Protocol Buffers, follow these steps:

````
sudo apt update
sudo apt install -y protobuf-compiler libprotobuf-dev
````
To ensure that the installation was successful, check the version of the Protocol Buffers compiler by running the following command:

````
protoc --version
````

### 1. Creating the `build/` Directory 

Now after the installation proceed to create the build folder. For this, navigate to the `app-cpp` folder and create the build folder by using the command below. This folder will contain the build files generated by CMake.

```` 
cd app-cpp
mkdir build
````

### 2. Run CMake commands to intiate the Build process

Navigate into the `build/` directory and run CMake commands to intialise the project.

````
cd build
cmake ..
````

### 3. Build the program

Navigate back into the `app-cpp` folder of the reposiory and run the build commands. The project already has the .proto file and the compiled files (.pb.cc and .pb.h), but just to ensure everything is up-to-date, you can recompile the .proto file.


```
cd ..
protoc --cpp_out=. serverMessages.proto
cmake --build build/
```
This command will regenerate the necessary C++ files (serverMessages.pb.cc and serverMessages.pb.h) based on the serverMessages.proto file and will also build the project.

### 4. Execute the program

Once the build is complete, run the server with the following command from the app-cpp directory. The number of worker threads can be specified as a command-line argument.

```
./build/file-retrieval-engine <port>
```

- `<port>` indicates the port number the server uses for its communication

#### 5. Start the client

Ensure that the server is running before starting the client. You can run the client by using the below given command

````
./build/file-retrieval-client
````

And for the benchmark program, you can use the following command 

````
./build/file-retrieval-benchmark 192.168.64.4 8080 1 ../../datasets/dataset1_client_server/1_client/client_1
````

which follows the format `./build/file-retrieval-benchmark <server IP> <server port> <number of clients> [<dataset path>]`

#### Example:

`Server`: The below given command will start the server at port 8080

````
./build/file-retrieval-server 8080
> <list | quit>  Server listening on port 8080
````

`Client`: The below given program will start the client program

````
./build/file-retrieval-client
> <connect | index | search | quit>
````


`For connection, indexing and searching`

````
./build/file-retrieval-client
> <connect | index | search | quit>  connect 192.168.64.4 8080
Connection Successfull!
> <connect | index | search | quit>  index ../../datasets/dataset1_client_server/2_clients/client_1
Completed indexing 68383239 bytes of data
Completed indexing in 11 seconds
> <connect | index | search | quit>  search at

Search completed in 0 seconds.
No results found
````

`For Benchmark`

```
./build/file-retrieval-benchmark 127.0.0.1 12345 2 ../datasets/dataset1_client_server/2_clients/client_1 ../datasets/dataset1_client_server/2_clients/client_2
Completed indexing 134247377 bytes of data
Completed indexing in 6.015 seconds
Searching at
Search completed in 0.4 seconds
Search results (top 10 out of 0):
Searching Worms
Search completed in 2.8 seconds
Search results (top 10 out of 12):
* client1:folder4/Document10553.txt:4
* client1:folder3/Document1043.txt:4
* client2:folder7/Document1091.txt:3
* client1:folder3/Document10383.txt:3
* client2:folder7/folderB/Document10991.txt:2
* client2:folder8/Document11116.txt:1
* client2:folder5/folderB/Document10706.txt:1
* client2:folder5/folderB/Document10705.txt:1
* client2:folder5/folderA/Document10689.txt:1
* client1:folder4/Document1051.txt:1
Searching distortion AND adaptation
Search completed in 3.27 seconds
Search results (top 10 out of 4):
* client2:folder7/folderC/Document10998.txt:6
* client1:folder4/Document10516.txt:3
* client2:folder8/Document11159.txt:2
* client2:folder8/Document11157.txt:2
```
